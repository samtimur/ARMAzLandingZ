{
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {}
        ],
        "steps": [
            {
                "name": "esNaming",
                "label": "Naming Conventions",
                "subLabel": {
                    "preValidation": "Provide naming prefix values for all Azure resources that will be created.",
                    "postValidation": "Done"
                },
                "bladeTitle": "namingConventions",
                "elements": [
                    {
                        "name": "text0",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Tenant level deployments require access at the tenant root (/) scope. Visit this link to ensure you have the appropriate RBAC permission to complete the deployment",
                            "uri": "https://docs.microsoft.com/azure/role-based-access-control/elevate-access-global-admin"
                        }
                    },
                    {
                        "name": "text1",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "The deployment will create the management group hierarchy under the Tenant Root Group with the prefix provided at this step.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                            }
                        }
                    },
                    {
                        "name": "esComIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Company Identifier Prefix",
                        "toolTip": "Provide a value for the company identifier, 1-5 characters.",
                        "defaultValue": "sjt",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{1,5}$",
                            "validationMessage": "The prefix must be 1-5 characters."
                        }
                    },
                    {
                        "name": "esLocIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Location Identifier Prefix",
                        "toolTip": "Provide a value for the location identifier, 3 characters (Australia East - SYD) or (Australia SouthEast - MEL)",
                        "defaultValue": "syd",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esPlatformIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Platform Subscription Identifier Prefix",
                        "toolTip": "Provide a value for the Platform Subscription Identifier.",
                        "defaultValue": "cor",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "text2",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Please provide Azure resource naming values:"
                        }
                    },
                    {
                        "name": "esArgIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Resource Group Identifier",
                        "toolTip": "Provide a value for the Resource Group identifier",
                        "defaultValue": "arg",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esLawIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Log Analytics Identifier",
                        "toolTip": "Provide a naming prefix for the Log Analytics workspace identifier",
                        "defaultValue": "law",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esVngIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Virtual Network Gateway Identifier",
                        "toolTip": "Provide a naming prefix for the Virtual Network Gateway identifier",
                        "defaultValue": "vng",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esVntIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Virtual Network Identifier",
                        "toolTip": "Provide a value for the Virtual Network identifier",
                        "defaultValue": "vnt",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esPipIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Public IP Identifier",
                        "toolTip": "Provide a naming prefix for the Public IP identifier",
                        "defaultValue": "pip",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esAfwIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Firewall Identifier",
                        "toolTip": "Provide a naming prefix for the Azure Firewall identifier",
                        "defaultValue": "afw",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esAfpIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Firewall Policy Identifier",
                        "toolTip": "Provide a naming prefix for the Azure Firewall Policy identifier",
                        "defaultValue": "afp",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esAaaIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Automation Identifier",
                        "toolTip": "Provide a naming prefix for the Azure Automation identifier",
                        "defaultValue": "aaa",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esStaIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Storage Identifier",
                        "toolTip": "Provide a value for the Storage identifier",
                        "defaultValue": "sta",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esUdrIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Route Table Identifier",
                        "toolTip": "Provide a value for the Route Table identifier",
                        "defaultValue": "udr",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esNsgIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Network Security Group Identifier",
                        "toolTip": "Provide a value for the Network Security Group identifier",
                        "defaultValue": "nsg",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esAkvIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Key Vault Identifier",
                        "toolTip": "Provide a value for the Azure Key Vault Identifier",
                        "defaultValue": "akv",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esRsvIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Recovery Services Vaults Identifier",
                        "toolTip": "Provide a value for the Recovery Services Vaults Identifier",
                        "defaultValue": "rsv",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esBasIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Bastion Identifier",
                        "toolTip": "Provide a value for the Azure Bastion Identifier",
                        "defaultValue": "bas",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esDdosIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure DDoS Protection Identifier",
                        "toolTip": "Provide a value for the Azure DDoS Protection Identifier",
                        "defaultValue": "ddos",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{4}$",
                            "validationMessage": "The prefix must be 4 characters."
                        }
                    },
                    {
                        "name": "esWanIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Virtual WAN Identifier",
                        "toolTip": "Provide a naming prefix for the Azure vWAN identifier",
                        "defaultValue": "wan",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "esHubIdentifier",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Virtual Hub Identifier",
                        "toolTip": "Provide a naming prefix for the Azure vHub identifier",
                        "defaultValue": "hub",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{3}$",
                            "validationMessage": "The prefix must be 3 characters."
                        }
                    },
                    {
                        "name": "text3",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Please provide values for the Landing Zone tags:"
                        }
                    },
                    {
                        "name": "esSubscriptionTag",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subscription Tag",
                        "toolTip": "Provide a value for the subscription tag",
                        "defaultValue": "platform",
                        "constraints": {
                            "required": false
                        }
                    },
                    {
                        "name": "esOwnerTag",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Owner Tag",
                        "toolTip": "Provide a value for the owner tag",
                        "defaultValue": "tulpy",
                        "constraints": {
                            "required": false
                        }
                    },
                    {
                        "name": "esCostCenterTag",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Cost Center Tag",
                        "toolTip": "Provide a value for the Cost Center tag",
                        "defaultValue": "1234",
                        "constraints": {
                            "required": false
                        }
                    }
                ]
            },
            {
                "name": "esPlatformManagement",
                "label": "Platform Management, Security, and Governance",
                "subLabel": {
                    "preValidation": "",
                    "postValidation": ""
                },
                "bladeTitle": "platformManagement",
                "elements": [
                    {
                        "name": "infoBox1",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "To enable the Platform Subscription, you must choose an Azure subscription. This subscription will be moved to the Platform Management Group and associated Platform resources will be deployed.",
                            "uri": "https://github.com/Azure/Enterprise-Scale/blob/main/docs/reference/Readme.md"
                        }
                    },
                    {
                        "name": "esLogAnalytics",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Log Analytics Workspace",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when adding an Azure Subscription, ARM will deploy resources and enable them for continuous compliance.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esLogRetention",
                        "type": "Microsoft.Common.Slider",
                        "min": 30,
                        "max": 730,
                        "label": "Log Analytics Data Retention (days)",
                        "subLabel": "Days",
                        "defaultValue": 30,
                        "showStepMarkers": false,
                        "toolTip": "Select retention days for Azure logs. Default is 30 days.",
                        "constraints": {
                            "required": false
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esPlatformSubSection",
                        "type": "Microsoft.Common.Section",
                        "label": "Platform Management Subscription",
                        "elements": [
                            {
                                "type": "Microsoft.Common.SubscriptionSelector",
                                "name": "esPlatformSub",
                                "label": "Platform Subscription"
                            }
                        ],
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "monitoring",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]",
                        "options": {
                            "text": "Select which Azure Monitor solutions to enable for the Log Analytics Workspace",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/azure-monitor/insights/solutions"
                            }
                        }
                    },
                    {
                        "name": "esAgentSolution",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Agent Health solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esChangeTracking",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Change Tracking solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esUpdateMgmt",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Update Management solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esActivityLog",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Activity Log solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esVmInsights",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy VM Insights solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esServiceMap",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Service Map solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esSqlAssessment",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy SQL Assessment solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esKeyVaultAnalytics",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Key Vault Analytics solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esContainerInsights",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Container Insights solution",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "security",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]",
                        "options": {
                            "text": "Select which Azure Security solutions to enable.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/security/fundamentals/overview"
                            }
                        }
                    },
                    {
                        "name": "esAsc",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Security Center and enable security monitoring for the Platform and resources",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esAscEmailContact",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Azure Security Center Email Contact",
                        "toolTip": "Provide the email contact for Azure Security Center alerts",
                        "defaultValue": "stephen.tulp@outlook.com",
                        "constraints": {
                            "required": "[equals(steps('esPlatformManagement').esAsc,'Yes')]",
                            "regex": "^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$",
                            "validationMessage": "Please provide a valid email address"
                        },
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]"
                    },
                    {
                        "name": "esAscVms",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Servers",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for all servers.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscApps",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for AppServices",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for AppServices.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscStorage",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Storage",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Storage.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscSql",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for SQL",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for SQL.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscSqlOnVm",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for SQL servers on machines",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for SQL servers on machines.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc,'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscKeyVault",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Key Vault",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Key Vault.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscArm",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Azure Resource Manager",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Resource Manager.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscDns",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for DNS",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for DNS.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscKubernetes",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Kubernetes",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Kubernetes.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscRegistries",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Container registries",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Container registries.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAscOsrdb",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Defender for Open-Source Relational Databases",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Defender will be enabled for Open-Source Relational Databases.",
                        "visible": "[equals(steps('esPlatformManagement').esAsc, 'Yes')]",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Standard"
                                },
                                {
                                    "label": "No, Azure Defender Off",
                                    "value": "Free"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esSecuritySolution",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Sentinel",
                        "defaultValue": "No",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esSta",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy a Storage account for diagnostics.",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, a Storage account will be deployed",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esActivityLogSta",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Long Term retention of Logs to Azure Storage.",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Long term retention of Azure Activity Logs to Azure Storage will be enabled",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esSta, 'Yes')]"
                    }
                ]
            },
            {
                "name": "esPlatformDevOps",
                "label": "Platform DevOps and Automation",
                "subLabel": {
                    "preValidation": "",
                    "postValidation": ""
                },
                "bladeTitle": "platformDevops",
                "elements": [
                    {
                        "name": "info",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[not(empty(steps('esPlatformManagement').esPlatformSubSection.esPlatformSub))]",
                        "options": {
                            "text": "Azure Foundations provides an integrated CI/CD pipeline via AzOps that can be used with either GitHub Actions or Azure DevOps pipelines.",
                            "uri": "https://github.com/azure/azops-accelerator/wiki/introduction",
                            "style": "Info"
                        }
                    },
                    {
                        "name": "correction",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[empty(steps('esPlatformManagement').esPlatformSubSection.esPlatformSub)]",
                        "options": {
                            "text": "Azure Foundations provides an integrated CI/CD pipeline via AzOps that can be used with either GitHub Actions or Azure DevOps pipelines, but requires a dedicated subscription for platform management in the previous step. Please add a subscription or continue without setting up the CI/CD integration.",
                            "uri": "https://github.com/azure/azops-accelerator/wiki/introduction",
                            "style": "Warning"
                        }
                    },
                    {
                        "name": "cicdOption",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy integrated CI/CD pipeline?",
                        "defaultValue": "Yes",
                        "toolTip": "",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ],
                            "required": true
                        },
                        "visible": "[not(empty(steps('esPlatformManagement').esPlatformSubSection.esPlatformSub))]"
                    },
                    {
                        "name": "Instructions",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]",
                        "options": {
                            "text": "Provide the credentials to initialize the repository with the ARM templates for Enterprise-Scale.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/management-group-and-subscription-organization"
                            }
                        }
                    },
                    {
                        "name": "optionsGroup1",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Select CI/CD option",
                        "defaultValue": "GitHub Actions",
                        "toolTip": "Azure Foundations will provide options for both GitHub Actions and Azure DevOps pipelines. For now, only GitHub Actions is available",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "GitHub Actions",
                                    "value": "actions"
                                }
                            ],
                            "required": true
                        },
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]"
                    },
                    {
                        "name": "esGit",
                        "type": "Microsoft.Common.TextBox",
                        "label": "GitHub organization or username",
                        "toolTip": "Provide Git org/username.",
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]",
                        "defaultValue": "",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{1,39}$",
                            "validationMessage": "The GitHub org/username must be 1-39 characters."
                        }
                    },
                    {
                        "name": "esGitRepoName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "New GitHub repository name",
                        "toolTip": "Provide a name for the new repository that will be created",
                        "defaultValue": "",
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]",
                        "placeholder": "",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z-]{1,100}$",
                            "validationMessage": "The repository name must be 1-100 characters."
                        }
                    },
                    {
                        "name": "esPaToken",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "GitHub personal access token",
                            "confirmPassword": "Confirm PA Token"
                        },
                        "toolTip": "Provide the personal access token to access your GitHub account or organization. For more information see this link: https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",
                        "constraints": {
                            "required": true,
                            "validationMessage": "Password must be at least 8 characters long, contain only numbers and letters"
                        },
                        "options": {
                            "hideConfirmation": true
                        },
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]"
                    },
                    {
                        "name": "spnSection",
                        "type": "Microsoft.Common.Section",
                        "label": "",
                        "elements": [
                            {
                                "name": "esServicePrincipal",
                                "type": "Microsoft.Common.ServicePrincipalSelector",
                                "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]",
                                "label": {
                                    "password": "Password",
                                    "certificateThumbprint": "Certificate thumbprint",
                                    "authenticationType": "Authentication Type",
                                    "sectionHeader": "Service Principal"
                                },
                                "toolTip": {
                                    "password": "Provide the application secret as it will be used to authenticate with Azure AD",
                                    "certificateThumbprint": "Certificate thumbprint",
                                    "authenticationType": "Authentication Type"
                                },
                                "defaultValue": {
                                    "principalId": "",
                                    "name": ""
                                },
                                "constraints": {
                                    "required": true
                                },
                                "options": {
                                    "hideCertificate": true
                                }
                            }
                        ],
                        "visible": "[equals(steps('esPlatformDevOps').cicdOption, 'Yes')]"
                    }
                ]
            },
            {
                "name": "esPlatformConnectivity",
                "label": "Platform Network Topology & Connectivity",
                "subLabel": {
                    "preValidation": "",
                    "postValidation": ""
                },
                "bladeTitle": "platformConnectivity",
                "elements": [
                    {
                        "name": "infoBox1",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Azure Foundations enables hybrid network connectivity with an on-premises environment using the Hub & Spoke network topology. Please note, all network connectivity components will be deployed to the Platform Subscription.",
                            "uri": "https://github.com/Azure/Enterprise-Scale/blob/main/docs/reference/Readme.md"
                        }
                    },
                    {
                        "name": "esHub",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Networking Topology",
                        "defaultValue": "Traditional Hub and Spoke",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy a Virtual Network Hub",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Traditional Hub and Spoke",
                                    "value": "vhub"
                                },
                                {
                                    "label": "Virtual WAN (Microsoft Managed)",
                                    "value": "vwan"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esAddressHubVWAN",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Address space (required for vWAN hub)",
                        "toolTip": "Provide address prefix in CIDR notation (e.g. 10.49.0.0/18)",
                        "defaultValue": "10.49.0.0/18",
                        "visible": "[and(not(equals(steps('esPlatformConnectivity').esHub, 'No')), not(equals(steps('esPlatformConnectivity').esHub, 'vhub')))]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The virtual hubs hub network address space, specified as one address prefix in CIDR notation (e.g. 10.100.0.0/23)",
                            "validations": [
                                {
                                    "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                    "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressHubHS",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Address space (required for hub virtual network)",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.49.0.0/18)",
                        "defaultValue": "10.49.0.0/18",
                        "visible": "[and(not(equals(steps('esPlatformConnectivity').esHub, 'No')), not(equals(steps('esPlatformConnectivity').esHub, 'vwan')))]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The virtual hubs hub network address space, specified as one address prefix in CIDR notation (e.g. 10.100.0.0/23)",
                            "validations": [
                                {
                                    "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(1[0-9]|2[0-4]))$",
                                    "message": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                                }
                            ]
                        }
                    },
                    {
                        "name": "esLocationsApi",
                        "type": "Microsoft.Solutions.ArmApiControl",
                        "request": {
                            "method": "GET",
                            "path": "locations?api-version=2019-11-01"
                        }
                    },
                    {
                        "name": "esNwLocation",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Region for the first networking hub",
                        "visible": "[not(equals(steps('esPlatformConnectivity').esHub, 'No'))]",
                        "toolTip": "Select the target Azure region for the deployment.",
                        "constraints": {
                            "allowedValues": "[map(steps('esPlatformConnectivity').esLocationsApi.value, (item) => parse(concat('{\"label\":\"', item.displayName, '\",\"value\":\"', item.name, '\"}')))]",
                            "required": true
                        }
                    },
                    {
                        "name": "esDdoS",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable DDoS Protection Standard",
                        "defaultValue": "No",
                        "visible": "[not(equals(steps('esPlatformConnectivity').esHub, 'No'))]",
                        "toolTip": "If 'Yes' is selected when also adding a platform subscription, DDoS Protection Standard will be enabled.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esEnablePrivateDnsZones",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Private DNS Zones",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Private DNS Zones will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[not(equals(steps('esPlatformConnectivity').esHub, 'No'))]"
                    },
                    {
                        "name": "esVpnGw",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy VPN Gateway",
                        "defaultValue": "No",
                        "visible": "[not(equals(steps('esPlatformConnectivity').esHub, 'No'))]",
                        "toolTip": "If 'Yes' is selected, ARM will deploy VPN gateway",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esGwRegionalOrAz",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy zone redundant or regional VPN Gateway",
                        "defaultValue": "Zone Redundant",
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esVpnGw,'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))), equals(steps('esPlatformConnectivity').esVpnGw,'Yes'), or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Virtual Gateway to the selected region and availability zones.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Zone Redundant",
                                    "value": "Zone"
                                },
                                {
                                    "label": "Regional",
                                    "value": "Regional"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esGwNoAzSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the VPN Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esVpnGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))), equals(steps('esPlatformConnectivity').esVpnGw,'Yes'), not(or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast'))))]",
                        "toolTip": "Select the required SKU for the VPN gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "VpnGw2",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                    "value": "VpnGw2"
                                },
                                {
                                    "label": "VpnGw3",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                    "value": "VpnGw3"
                                },
                                {
                                    "label": "VpnGw4",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                    "value": "VpnGw4"
                                },
                                {
                                    "label": "VpnGw5",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                    "value": "VpnGw5"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esGwAzSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the VPN Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esVpnGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))), equals(steps('esPlatformConnectivity').esVpnGw,'Yes'), equals(steps('esPlatformConnectivity').esGwRegionalOrAz, 'Zone') ,or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "Select the required SKU for the VPN gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "VpnGw2AZ",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                    "value": "VpnGw2AZ"
                                },
                                {
                                    "label": "VpnGw3AZ",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                    "value": "VpnGw3AZ"
                                },
                                {
                                    "label": "VpnGw4AZ",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                    "value": "VpnGw4AZ"
                                },
                                {
                                    "label": "VpnGw5AZ",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                    "value": "VpnGw5AZ"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esGwRegionalSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the VPN Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esVpnGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))), equals(steps('esPlatformConnectivity').esVpnGw,'Yes'), equals(steps('esPlatformConnectivity').esGwRegionalOrAz, 'Regional') ,or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "Select the required SKU for the VPN gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "VpnGw2",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 500 IKEv2/OpenVPN connections, aggregate throughput is 1.25 Gbps",
                                    "value": "VpnGw2"
                                },
                                {
                                    "label": "VpnGw3",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 1000 IKEv2/OpenVPN connections, aggregate throughput is 2.5 Gbps",
                                    "value": "VpnGw3"
                                },
                                {
                                    "label": "VpnGw4",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 5000 IKEv2/OpenVPN connections, aggregate throughput is 5 Gbps",
                                    "value": "VpnGw4"
                                },
                                {
                                    "label": "VpnGw5",
                                    "description": "Supports BGP, max 30 S2S/VNet-VNet tunnels, max 128 P2S SSTP connections, max 10000 IKEv2/OpenVPN connections, aggregate throughput is 10 Gbps",
                                    "value": "VpnGw5"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressVpnOrEr",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for VPN/ExpressRoute Gateway",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.49.63.0/27)",
                        "defaultValue": "10.49.63.0/27",
                        "visible": "[or(equals(steps('esPlatformConnectivity').esErGw, 'Yes'), equals(steps('esPlatformConnectivity').esVpnGw, 'Yes'))]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The subnet network's address space, specified as one address prefixes in CIDR notation (e.g 10.100.0.0/24)",
                            "validations": [
                                {
                                    "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-7]))$",
                                    "message": "Invalid CIDR range. The address prefix must be /26 or /27."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressVpnOrEr, '/')), '.'), 1))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (first octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressVpnOrEr, '/')), '.'), 2))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (second octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressVpnOrEr, '/')), '.'), 3))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (third octet)."
                                },
                                {
                                    "isValid": "[lessOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), last(split(steps('esPlatformConnectivity').esAddressVpnOrEr, '/')))]",
                                    "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                }
                            ]
                        }
                    },
                    {
                        "name": "esErGw",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy ExpressRoute Gateway",
                        "defaultValue": "No",
                        "visible": "[not(equals(steps('esPlatformConnectivity').esHub, 'No'))]",
                        "toolTip": "If 'Yes' is selected, ARM will deploy an ExpressRoute gateway",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esErRegionalOrAz",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy zone redundant or regional ExpressRoute Gateway",
                        "defaultValue": "Zone redundant",
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esErGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))),equals(steps('esPlatformConnectivity').esErGw,'Yes'), or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Express Route Gateway to the selected region and availability zones.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Zone redundant",
                                    "value": "Zone"
                                },
                                {
                                    "label": "Regional",
                                    "value": "Regional"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esErAzSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the ExpressRoute Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esErGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))),equals(steps('esPlatformConnectivity').esErGw,'Yes'), equals(steps('esPlatformConnectivity').esErRegionalOrAz, 'Zone'), or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "Select the required SKU for the Express Route gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "ErGw1AZ",
                                    "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of circuit connections is 4",
                                    "value": "ErGw1AZ"
                                },
                                {
                                    "label": "ErGw2AZ",
                                    "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of circuit connections is 8",
                                    "value": "ErGw2AZ"
                                },
                                {
                                    "label": "ErGw3AZ",
                                    "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of circuit connections is 16",
                                    "value": "ErGw3AZ"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esErRegionalSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the ExpressRoute Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esErGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))), equals(steps('esPlatformConnectivity').esErGw,'Yes'), equals(steps('esPlatformConnectivity').esErRegionalOrAz, 'Regional'), or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast')))]",
                        "toolTip": "Select the required SKU for the Express Route gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard",
                                    "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of circuit connections is 4",
                                    "value": "Standard"
                                },
                                {
                                    "label": "HighPerformance",
                                    "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of circuit connections is 8",
                                    "value": "HighPerformance"
                                },
                                {
                                    "label": "UltraPerformance",
                                    "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of circuit connections is 16",
                                    "value": "UltraPerformance"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esErNoAzSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select the ExpressRoute Gateway SKU",
                        "defaultValue": "",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[and(and(equals(steps('esPlatformConnectivity').esErGw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan'))),equals(steps('esPlatformConnectivity').esErGw,'Yes'), not(or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation,'canadacentral'),equals(steps('esPlatformConnectivity').esNwLocation,'centralus')),equals(steps('esPlatformConnectivity').esNwLocation,'eastus'),equals(steps('esPlatformConnectivity').esNwLocation,'eastus2')),equals(steps('esPlatformConnectivity').esNwLocation,'southcentralus'),equals(steps('esPlatformConnectivity').esNwLocation,'westus2')),equals(steps('esPlatformConnectivity').esNwLocation,'francecentral'),equals(steps('esPlatformConnectivity').esNwLocation,'germanywestcentral')),equals(steps('esPlatformConnectivity').esNwLocation,'northeurope'),equals(steps('esPlatformConnectivity').esNwLocation,'westeurope')),equals(steps('esPlatformConnectivity').esNwLocation,'uksouth'),equals(steps('esPlatformConnectivity').esNwLocation,'southafricanorth')),equals(steps('esPlatformConnectivity').esNwLocation,'japaneast'),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia')),equals(steps('esPlatformConnectivity').esNwLocation,'southeastasia'),equals(steps('esPlatformConnectivity').esNwLocation,'australiaeast'))))]",
                        "toolTip": "Select the required SKU for the Express Route gateway.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard",
                                    "description": "Megabits per second 1000, packets per second 100,000, connections per second 7000, max number of circuit connections is 4",
                                    "value": "Standard"
                                },
                                {
                                    "label": "HighPerformance",
                                    "description": "Megabits per second 2000, packets per second 250,000, connections per second 14000, max number of circuit connections is 8",
                                    "value": "HighPerformance"
                                },
                                {
                                    "label": "UltraPerformance",
                                    "description": "Megabits per second 10,000, packets per second 1,000,000, connections per second 28,000, max number of circuit connections is 16",
                                    "value": "UltraPerformance"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAzFw",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Firewall",
                        "defaultValue": "No",
                        "visible": "[or(equals(steps('esPlatformConnectivity').esHub, 'vhub'), equals(steps('esPlatformConnectivity').esHub, 'vwan'))]",
                        "toolTip": "If 'Yes' is selected, an Azure Firewall will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAzFwDns",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Firewall as a DNS proxy",
                        "defaultValue": "Yes",
                        "visible": "[equals(steps('esPlatformConnectivity').esAzFw, 'Yes')]",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will enable Azure Firewall as a DNS Proxy.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAzFwSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select Azure Firewall Sku",
                        "defaultValue": "Standard",
                        "multiselect": false,
                        "selectAll": false,
                        "filter": false,
                        "multiLine": true,
                        "visible": "[equals(steps('esPlatformConnectivity').esAzFw, 'Yes')]",
                        "toolTip": "Select Azure Firewall Sku",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard",
                                    "description": "Standard Azure Firewall",
                                    "value": "Standard"
                                },
                                {
                                    "label": "Premium",
                                    "description": "Premium Azure Firewall adds support for TLS inspection, IDPS, URL filtering and web categories.",
                                    "value": "Premium"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esFwAz",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select Availability Zones for the Azure Firewall",
                        "defaultValue": "None",
                        "multiselect": true,
                        "selectAll": true,
                        "filter": true,
                        "visible": "[and(equals(steps('esPlatformConnectivity').esAzFw,'Yes'), or(or(or(or(or(or(or(or(equals(steps('esPlatformConnectivity').esNwLocation, 'canadacentral'), equals(steps('esPlatformConnectivity').esNwLocation, 'centralus')), equals(steps('esPlatformConnectivity').esNwLocation, 'eastus'), equals(steps('esPlatformConnectivity').esNwLocation, 'eastus2')), equals(steps('esPlatformConnectivity').esNwLocation, 'southcentralus'), equals(steps('esPlatformConnectivity').esNwLocation, 'westus2')), equals(steps('esPlatformConnectivity').esNwLocation, 'francecentral'), equals(steps('esPlatformConnectivity').esNwLocation, 'germanywestcentral')), equals(steps('esPlatformConnectivity').esNwLocation, 'northeurope'), equals(steps('esPlatformConnectivity').esNwLocation, 'westeurope')), equals(steps('esPlatformConnectivity').esNwLocation, 'uksouth'), equals(steps('esPlatformConnectivity').esNwLocation, 'southafricanorth')), equals(steps('esPlatformConnectivity').esNwLocation, 'japaneast'), equals(steps('esPlatformConnectivity').esNwLocation, 'southeastasia')), equals(steps('esPlatformConnectivity').esNwLocation, 'southeastasia'), equals(steps('esPlatformConnectivity').esNwLocation, 'australiaeast')))]",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for connectivity, ARM will deploy Azure Firewall to the selected region and availability zones.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Zone 1",
                                    "value": "1"
                                },
                                {
                                    "label": "Zone 2",
                                    "value": "2"
                                },
                                {
                                    "label": "Zone 3",
                                    "value": "3"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressFw",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for Azure Firewall",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                        "defaultValue": "10.49.61.0/24",
                        "visible": "[and(equals(steps('esPlatformConnectivity').esAzFw, 'Yes'), not(equals(steps('esPlatformConnectivity').esHub, 'vwan')))]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The subnet network's address space, specified as one address prefixes in CIDR notation (e.g 10.100.0.0/24)",
                            "validations": [
                                {
                                    "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[0-6]))$",
                                    "message": "Invalid CIDR range. The address prefix must be in the range [20,26]."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressFw, '/')), '.'), 1))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (first octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressFw, '/')), '.'), 2))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (second octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressFw, '/')), '.'), 3))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (third octet)."
                                },
                                {
                                    "isValid": "[lessOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), last(split(steps('esPlatformConnectivity').esAddressFw, '/')))]",
                                    "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAzBastion",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Bastion",
                        "defaultValue": "No",
                        "visible": "[equals(steps('esPlatformConnectivity').esHub, 'vhub')]",
                        "toolTip": "If 'Yes' is selected, an Azure Bastion will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressBastion",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for Azure Bastion",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                        "defaultValue": "10.49.2.0/24",
                        "visible": "[equals(steps('esPlatformConnectivity').esAzBastion, 'Yes')]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The subnet network's address space, specified as one address prefixes in CIDR notation (e.g 10.100.0.0/24)",
                            "validations": [
                                {
                                    "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\/(2[4-7]))$",
                                    "message": "Invalid CIDR range. The address prefix must be a /24 to /27."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 8), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 1)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressBastion, '/')), '.'), 1))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (first octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 16), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 2)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressBastion, '/')), '.'), 2))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (second octet)."
                                },
                                {
                                    "isValid": "[if(greaterOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), 24), equals(last(take(split(first(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), '.'), 3)), last(take(split(first(split(steps('esPlatformConnectivity').esAddressBastion, '/')), '.'), 3))), true)]",
                                    "message": "CIDR range not within virtual network CIDR range (third octet)."
                                },
                                {
                                    "isValid": "[lessOrEquals(last(split(steps('esPlatformConnectivity').esAddressHubHS, '/')), last(split(steps('esPlatformConnectivity').esAddressBastion, '/')))]",
                                    "message": "CIDR range not within virtual network CIDR range (subnet mask)."
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAppGw",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure App Gateway Subnet",
                        "defaultValue": "Yes",
                        "visible": "[equals(steps('esPlatformConnectivity').esHub, 'vhub')]",
                        "toolTip": "If 'Yes' is selected, a subnet for App Gateways will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressAppGw",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for Azure App gateways",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                        "defaultValue": "10.49.62.0/24",
                        "visible": "[equals(steps('esPlatformConnectivity').esAppGw, 'Yes')]",
                        "constraints": {
                            "required": true,
                            "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:$|/(1[0-9]|2[0-9]))$",
                            "validationMessage": "Invalid CIDR range. The address prefix must be in the range [10,24]."
                        }
                    },
                    {
                        "name": "esMgmt",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Management Subnet",
                        "defaultValue": "Yes",
                        "visible": "[equals(steps('esPlatformConnectivity').esHub, 'vhub')]",
                        "toolTip": "If 'Yes' is selected, a subnet for Management Services will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressMgmt",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for Management services",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                        "defaultValue": "10.49.0.0/24",
                        "visible": "[equals(steps('esPlatformConnectivity').esMgmt, 'Yes')]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The subnet network's address space, specified as one address prefixes in CIDR notation (e.g. 192.168.1.0/24)"
                        }
                    },
                    {
                        "name": "esIdentity",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Azure Identity Subnet",
                        "defaultValue": "Yes",
                        "visible": "[equals(steps('esPlatformConnectivity').esHub, 'vhub')]",
                        "toolTip": "If 'Yes' is selected, a subnet for Active Directory Domain Services will be deployed.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esAddressIdentity",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Subnet for Identity services",
                        "toolTip": "Provide address prefix in CIDR notation (e.g 10.100.0.0/24)",
                        "defaultValue": "10.49.1.0/24",
                        "visible": "[equals(steps('esPlatformConnectivity').esIdentity, 'Yes')]",
                        "constraints": {
                            "required": true,
                            "validationMessage": "The subnet network's address space, specified as one address prefixes in CIDR notation (e.g. 192.168.1.0/24)"
                        }
                    }
                ]
            },
            {
                "name": "lzGoalState",
                "label": "Landing Zone Configuration",
                "subLabel": {
                    "preValidation": "",
                    "postValidation": ""
                },
                "bladeTitle": "lzGs",
                "elements": [
                    {
                        "name": "infoBox1",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "You can optionally provide subscriptions for your first landing zones for both 'online' and 'corp' and assign recommended policies that will ensure workloads will be secure, monitored, and protected according to best practices.",
                            "uri": "https://github.com/Azure/Enterprise-Scale/blob/main/docs/Deploy/ES-schema.md"
                        }
                    },
                    {
                        "name": "corpText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Select the subscriptions you want to move to Corp Landing Zone Management Group.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                            }
                        }
                    },
                    {
                        "name": "lzCorpSubsApi",
                        "type": "Microsoft.Solutions.ArmApiControl",
                        "request": {
                            "method": "GET",
                            "path": "subscriptions?api-version=2020-01-01"
                        }
                    },
                    {
                        "name": "esCorpLzSub",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Add Corp Landing Zone Subscriptions (optional)",
                        "toolTip": "",
                        "multiselect": true,
                        "selectAll": true,
                        "filter": true,
                        "filterPlaceholder": "Filter items ...",
                        "multiLine": true,
                        "visible": true,
                        "constraints": {
                            "allowedValues": "[map(filter(steps('lzGoalState').lzCorpSubsApi.value, (sub) => equals(sub.state, 'Enabled')), (sub) => parse(concat('{\"label\":\"',sub.displayName,'\",\"description\":\"',sub.subscriptionId,'\",\"value\":\"',toLower(sub.subscriptionId),'\"}')))]",
                            "required": false
                        }
                    },
                    {
                        "name": "onlineText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Select the subscriptions you want to move to Online Landing Zone Management Group.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#subscription-democratization"
                            }
                        }
                    },
                    {
                        "name": "lzOnlineSubsApi",
                        "type": "Microsoft.Solutions.ArmApiControl",
                        "request": {
                            "method": "GET",
                            "path": "subscriptions?api-version=2020-01-01"
                        }
                    },
                    {
                        "name": "esOnlineLzSub",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Add Online Landing Zone Subscriptions (optional)",
                        "toolTip": "",
                        "multiselect": true,
                        "selectAll": true,
                        "filter": true,
                        "filterPlaceholder": "Filter items ...",
                        "multiLine": true,
                        "visible": true,
                        "constraints": {
                            "allowedValues": "[map(filter(steps('lzGoalState').lzOnlineSubsApi.value, (sub) => equals(sub.state, 'Enabled')), (sub) => parse(concat('{\"label\":\"',sub.displayName,'\",\"description\":\"',sub.subscriptionId,'\",\"value\":\"',toLower(sub.subscriptionId),'\"}')))]",
                            "required": false
                        }
                    },
                    {
                        "name": "azMonText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Select which of the the recommended policies you will assign to your landing zones.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/enterprise-scale/design-principles#policy-driven-governance"
                            }
                        }
                    },
                    {
                        "name": "esSqlAudit",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure auditing is enabled on Azure SQL",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure auditing is enabled on Azure SQL",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esSqlEncryption",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure Azure SQL is enabled with transparent data encryption",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esAksPolicy",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Kubernetes (AKS) for Azure Policy",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esAksPriv",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent privileged containers in Kubernetes clusters",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, policy will be assigned to prevent privileged containers in AKS",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esAksNoPriv",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent privileged escalation in Kubernetes clusters",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, policy will be assigned to prevent privileged escalations in AKS",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esAksIngress",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure HTTPS ingress is enforced in Kubernetes clusters",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, HTTPS ingress will be required in AKS",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esDenyPip",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent Public IP Addresses",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent Public IP Addresses",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esDenyRdp",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent inbound RDP from internet",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent inbound RDP from internet",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esHttpsStorage",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure secure connections (HTTPS) to storage accounts",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure storage can only be accessed using HTTPS",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esIpForwarding",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent IP forwarding",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent IP forwarding",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esNsg",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure subnets are associated with NSG",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned to ensure Network Security Groups must be associated with subnets being created",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esDenySsh",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent inbound SSH from internet",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected, Azure Policy will be assigned and prevent inbound SSH from internet",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "esLzPrivateLink",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Prevent usage of Public Endpoints for PaaS services in the corp connected landing zones",
                        "defaultValue": "Yes",
                        "visible": true,
                        "toolTip": "If 'Yes' is selected then Azure Policy will prevent PaaS resources to use public endpoints.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esEncryptionInTransit",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure encryption in transit is enabled for PaaS services",
                        "defaultValue": "Yes",
                        "visible": true,
                        "toolTip": "If 'Yes' is selected then Azure Policy will ensure PaaS resources uses TLS and SSL.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        }
                    },
                    {
                        "name": "esVmMonitoring",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure Azure VMs (Windows & Linux) are being monitored",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esVmssMonitoring",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure Azure VMSS (Windows & Linux) are being monitored",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    },
                    {
                        "name": "esArcVmMonitoring",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Ensure Azure Arc VMs (Windows & Linux) are being monitored",
                        "defaultValue": "Yes",
                        "toolTip": "If 'Yes' is selected when also adding a subscription for management, ARM will deploy resources and enable them for continuous compliance",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "Yes"
                                },
                                {
                                    "label": "No",
                                    "value": "No"
                                }
                            ]
                        },
                        "visible": "[equals(steps('esPlatformManagement').esLogAnalytics, 'Yes')]"
                    }
                ]
            }
        ],
        "outputs": {
            "enterpriseScaleCompanyPrefix": "[steps('esNaming').esComIdentifier]",
            "locationPrefix": "[steps('esNaming').esLocIdentifier]",
            "platformPrefix": "[steps('esNaming').esPlatformIdentifier]",
            "argPrefix": "[steps('esNaming').esArgIdentifier]",
            "lawPrefix": "[steps('esNaming').esLawIdentifier]",
            "vngPrefix": "[steps('esNaming').esVngIdentifier]",
            "vntPrefix": "[steps('esNaming').esVntIdentifier]",
            "pipPrefix": "[steps('esNaming').esPipIdentifier]",
            "afwPrefix": "[steps('esNaming').esAfwIdentifier]",
            "afpPrefix": "[steps('esNaming').esAfpIdentifier]",
            "aaaPrefix": "[steps('esNaming').esAaaIdentifier]",
            "staPrefix": "[steps('esNaming').esStaIdentifier]",
            "udrPrefix": "[steps('esNaming').esUdrIdentifier]",
            "nsgPrefix": "[steps('esNaming').esNsgIdentifier]",
            "akvPrefix": "[steps('esNaming').esAkvIdentifier]",
            "rsvPrefix": "[steps('esNaming').esRsvIdentifier]",
            "basPrefix": "[steps('esNaming').esBasIdentifier]",
            "ddosPrefix": "[steps('esNaming').esDdosIdentifier]",
            "vHubPrefix": "[steps('esNaming').esHubIdentifier]",
            "vWanPrefix": "[steps('esNaming').esWanIdentifier]",
            "subscriptionTag": "[steps('esNaming').esSubscriptionTag]",
            "ownerTag": "[steps('esNaming').esOwnerTag]",
            "costCenterTag": "[steps('esNaming').esCostCenterTag]",
            "platformSubscriptionId": "[steps('esPlatformManagement').esPlatformSubSection.esPlatformSub.subscriptionId]",
            "enableLogAnalytics": "[steps('esPlatformManagement').esLogAnalytics]",
            "retentionInDays": "[string(steps('esPlatformManagement').esLogRetention)]",
            "enableAsc": "[steps('esPlatformManagement').esAsc]",
            "emailContactAsc": "[steps('esPlatformManagement').esAscEmailContact]",
            "enableSecuritySolution": "[steps('esPlatformManagement').esSecuritySolution]",
            "enableAgentHealth": "[steps('esPlatformManagement').esAgentSolution]",
            "enableChangeTracking": "[steps('esPlatformManagement').esChangeTracking]",
            "enableUpdateMgmt": "[steps('esPlatformManagement').esUpdateMgmt]",
            "enableActivityLog": "[steps('esPlatformManagement').esActivityLog]",
            "enableVmInsights": "[steps('esPlatformManagement').esVmInsights]",
            "enableServiceMap": "[steps('esPlatformManagement').esServiceMap]",
            "enableSqlAssessment": "[steps('esPlatformManagement').esSqlAssessment]",
            "enableKeyVaultAnalytics": "[steps('esPlatformManagement').esKeyVaultAnalytics]",
            "enableContainerInsights": "[steps('esPlatformManagement').esContainerInsights]",
            "enableStorage": "[steps('esPlatformManagement').esSta]",
            "enableLtrStorage": "[steps('esPlatformManagement').esActivityLogSta]",
            "enableAscForServers": "[steps('esPlatformManagement').esAscVms]",
            "enableAscForAppServices": "[steps('esPlatformManagement').esAscApps]",
            "enableAscForStorage": "[steps('esPlatformManagement').esAscStorage]",
            "enableAscForSql": "[steps('esPlatformManagement').esAscSql]",
            "enableAscForSqlOnVm": "[steps('esPlatformManagement').esAscSqlOnVm]",
            "enableAscForKeyVault": "[steps('esPlatformManagement').esAscKeyVault]",
            "enableAscForArm": "[steps('esPlatformManagement').esAscArm]",
            "enableAscForDns": "[steps('esPlatformManagement').esAscDns]",
            "enableAscForKubernetes": "[steps('esPlatformManagement').esAscKubernetes]",
            "enableAscForRegistries": "[steps('esPlatformManagement').esAscRegistries]",
            "enableAscForOsrdb": "[steps('esPlatformManagement').esAscOsrdb]",
            "paToken": "[steps('esPlatformDevOps').esPaToken]",
            "principalId": "[steps('esPlatformDevOps').spnSection.esServicePrincipal.objectId]",
            "principalSecret": "[steps('esPlatformDevOps').spnSection.esServicePrincipal.password]",
            "gitHubUserNameOrOrg": "[steps('esPlatformDevOps').esGit]",
            "appId": "[steps('esPlatformDevOps').spnSection.esServicePrincipal.appId]",
            "enableAzOps": "[steps('esPlatformDevOps').cicdOption]",
            "repositoryName": "[steps('esPlatformDevOps').esGitRepoName]",
            "enableErGw": "[steps('esPlatformConnectivity').esErGw]",
            "enableVpnGw": "[steps('esPlatformConnectivity').esVpnGw]",
            "enableHub": "[steps('esPlatformConnectivity').esHub]",
            "enableDdoS": "[steps('esPlatformConnectivity').esDdoS]",
            "enableAzBastion": "[steps('esPlatformConnectivity').esAzBastion]",
            "enableAzFw": "[steps('esPlatformConnectivity').esAzFw]",
            "enableAzFwDnsProxy": "[steps('esPlatformConnectivity').esAzFwDns]",
            "firewallSku": "[steps('esPlatformConnectivity').esAzFwSku]",
            "firewallZones": "[steps('esPlatformConnectivity').esFwAz]",
            "enableAppGw": "[steps('esPlatformConnectivity').esAppGw]",
            "enableMgmt": "[steps('esPlatformConnectivity').esMgmt]",
            "enableIdentity": "[steps('esPlatformConnectivity').esIdentity]",
            "connectivityAddressPrefix": "[coalesce(steps('esPlatformConnectivity').esAddressHubVWAN, steps('esPlatformConnectivity').esAddressHubHS, '')]",
            "location": "[steps('esPlatformConnectivity').esNwLocation]",
            "enablePrivateDnsZones": "[steps('esPlatformConnectivity').esEnablePrivateDnsZones]",
            "vpnOrErZones": "[steps('esPlatformConnectivity').esGwRegionalOrAz]",
            "gwRegionalOrAz": "[steps('esPlatformConnectivity').esGwRegionalOrAz]",
            "gwRegionalSku": "[if(empty(steps('esPlatformConnectivity').esGwRegionalSku), steps('esPlatformConnectivity').esGwNoAzSku, steps('esPlatformConnectivity').esGwRegionalSku)]",
            "gwAzSku": "[steps('esPlatformConnectivity').esGwAzSku]",
            "erRegionalOrAz": "[steps('esPlatformConnectivity').esErRegionalOrAz]",
            "erRegionalSku": "[if(empty(steps('esPlatformConnectivity').esErRegionalSku), steps('esPlatformConnectivity').esErNoAzSku, steps('esPlatformConnectivity').esErRegionalSku)]",
            "erAzSku": "[steps('esPlatformConnectivity').esErAzSku]",
            "subnetMaskForGw": "[steps('esPlatformConnectivity').esAddressVpnOrEr]",
            "subnetMaskForAzBastion": "[steps('esPlatformConnectivity').esAddressBastion]",
            "subnetMaskForAzFw": "[steps('esPlatformConnectivity').esAddressFw]",
            "subnetMaskForAppGw": "[steps('esPlatformConnectivity').esAddressAppGw]",
            "subnetMaskForMgmt": "[steps('esPlatformConnectivity').esAddressMgmt]",
            "subnetMaskForIdentity": "[steps('esPlatformConnectivity').esAddressIdentity]",
            "enableSqlAudit": "[steps('lzGoalState').esSqlAudit]",
            "enableSqlEncryption": "[steps('lzGoalState').esSqlEncryption]",
            "enableAksPolicy": "[steps('lzGoalState').esAksPolicy]",
            "denyAksPrivileged": "[steps('lzGoalState').esAksPriv]",
            "denyAksPrivilegedEscalation": "[steps('lzGoalState').esAksNoPriv]",
            "denyHttpIngressForAks": "[steps('lzGoalState').esAksIngress]",
            "denyPip": "[steps('lzGoalState').esDenyPip]",
            "denyRdp": "[steps('lzGoalState').esDenyRdp]",
            "enableStorageHttps": "[steps('lzGoalState').esHttpsStorage]",
            "denyIpForwarding": "[steps('lzGoalState').esIpForwarding]",
            "denySubnetWithoutNsg": "[steps('lzGoalState').esNsg]",
            "denySsh": "[steps('lzGoalState').esDenySsh]",
            "denyPublicEndpoints": "[steps('lzGoalState').esLzPrivateLink]",
            "enableEncryptionInTransit": "[steps('lzGoalState').esEncryptionInTransit]",
            "enableVmMonitoring": "[steps('lzGoalState').esVmMonitoring]",
            "enableVmssMonitoring": "[steps('lzGoalState').esVmssMonitoring]",
            "enableArcMonitoring": "[steps('lzGoalState').esArcVmMonitoring]"
        }
    }
}